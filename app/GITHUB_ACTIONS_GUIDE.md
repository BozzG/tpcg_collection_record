# ğŸ”„ GitHub Actionsè‡ªåŠ¨æ„å»ºå®Œæ•´æŒ‡å—

## ğŸ¯ æ–¹æ³•äºŒï¼šGitHub Actionsè‡ªåŠ¨æ„å»ºè¯¦è§£

### ğŸ“‹ å·¥ä½œåŸç†
GitHub Actionsä¼šåœ¨äº‘ç«¯çš„Windowsè™šæ‹Ÿæœºä¸Šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
1. æ£€å‡ºä½ çš„ä»£ç 
2. è®¾ç½®Flutterå¼€å‘ç¯å¢ƒ
3. å®‰è£…é¡¹ç›®ä¾èµ–
4. æ„å»ºWindowsåº”ç”¨
5. æ‰“åŒ…å¹¶ä¸Šä¼ æ„å»ºäº§ç‰©

### ğŸš€ è¯¦ç»†æ“ä½œæ­¥éª¤

#### ç¬¬ä¸€æ­¥ï¼šæ¨é€ä»£ç åˆ°GitHub

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
cd /Users/bozzguo/project/tpcg_collection_record

# åˆå§‹åŒ–Gitä»“åº“ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
git init

# æ·»åŠ æ‰€æœ‰æ–‡ä»¶
git add .

# æäº¤ä»£ç 
git commit -m "Add Flutter card collection app with Windows support"

# æ·»åŠ GitHubè¿œç¨‹ä»“åº“ï¼ˆæ›¿æ¢ä¸ºä½ çš„ä»“åº“åœ°å€ï¼‰
git remote add origin https://github.com/ä½ çš„ç”¨æˆ·å/tpcg-collection-record.git

# æ¨é€åˆ°GitHub
git push -u origin main
```

#### ç¬¬äºŒæ­¥ï¼šè§¦å‘è‡ªåŠ¨æ„å»º

æœ‰4ç§æ–¹å¼è§¦å‘æ„å»ºï¼š

##### æ–¹å¼1ï¼šæ¨é€ä»£ç ï¼ˆè‡ªåŠ¨è§¦å‘ï¼‰
```bash
# ä»»ä½•æ¨é€åˆ°mainæˆ–developåˆ†æ”¯éƒ½ä¼šè‡ªåŠ¨è§¦å‘æ„å»º
git push origin main
```

##### æ–¹å¼2ï¼šåˆ›å»ºPull Requestï¼ˆè‡ªåŠ¨è§¦å‘ï¼‰
åœ¨GitHubç½‘é¡µä¸Šåˆ›å»ºPRåˆ°mainåˆ†æ”¯

##### æ–¹å¼3ï¼šæ‰‹åŠ¨è§¦å‘
1. æ‰“å¼€GitHubä»“åº“é¡µé¢
2. ç‚¹å‡» "Actions" æ ‡ç­¾
3. é€‰æ‹© "ğŸªŸ Build Windows App" å·¥ä½œæµ
4. ç‚¹å‡» "Run workflow" æŒ‰é’®
5. é€‰æ‹©æ„å»ºç±»å‹ï¼ˆdebug/releaseï¼‰
6. ç‚¹å‡» "Run workflow"

##### æ–¹å¼4ï¼šåˆ›å»ºç‰ˆæœ¬æ ‡ç­¾ï¼ˆå‘å¸ƒç‰ˆæœ¬ï¼‰
```bash
# åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾
git tag v1.0.0
git push origin v1.0.0
```

#### ç¬¬ä¸‰æ­¥ï¼šç›‘æ§æ„å»ºè¿‡ç¨‹

1. **æ‰“å¼€Actionsé¡µé¢**
   - åœ¨GitHubä»“åº“ä¸­ç‚¹å‡» "Actions" æ ‡ç­¾
   
2. **æŸ¥çœ‹æ„å»ºçŠ¶æ€**
   - ğŸŸ¡ é»„è‰²ï¼šæ„å»ºè¿›è¡Œä¸­
   - ğŸŸ¢ ç»¿è‰²ï¼šæ„å»ºæˆåŠŸ
   - ğŸ”´ çº¢è‰²ï¼šæ„å»ºå¤±è´¥
   
3. **æŸ¥çœ‹è¯¦ç»†æ—¥å¿—**
   - ç‚¹å‡»å…·ä½“çš„æ„å»ºä»»åŠ¡
   - å±•å¼€å„ä¸ªæ­¥éª¤æŸ¥çœ‹è¯¦ç»†è¾“å‡º

#### ç¬¬å››æ­¥ï¼šä¸‹è½½æ„å»ºäº§ç‰©

##### ä»Actionsé¡µé¢ä¸‹è½½ï¼š
1. è¿›å…¥æˆåŠŸçš„æ„å»ºä»»åŠ¡é¡µé¢
2. æ»šåŠ¨åˆ°é¡µé¢åº•éƒ¨çš„ "Artifacts" éƒ¨åˆ†
3. ç‚¹å‡»ä¸‹è½½ `tpcg-collection-record-windows-xxx.zip`

##### ä»Releasesé¡µé¢ä¸‹è½½ï¼ˆç‰ˆæœ¬å‘å¸ƒï¼‰ï¼š
1. åœ¨ä»“åº“ä¸»é¡µç‚¹å‡» "Releases"
2. æ‰¾åˆ°å¯¹åº”ç‰ˆæœ¬
3. ä¸‹è½½é™„ä»¶ä¸­çš„zipæ–‡ä»¶

### ğŸ“Š æ„å»ºäº§ç‰©è¯´æ˜

ä¸‹è½½çš„zipæ–‡ä»¶åŒ…å«ï¼š
```
tpcg-collection-record-windows-xxx.zip
â”œâ”€â”€ tpcg_collection_record.exe    # ä¸»ç¨‹åº
â”œâ”€â”€ flutter_windows.dll           # Flutterè¿è¡Œæ—¶
â”œâ”€â”€ data/                         # åº”ç”¨èµ„æº
â”‚   â”œâ”€â”€ icudtl.dat
â”‚   â”œâ”€â”€ flutter_assets/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ VERSION.txt                   # ç‰ˆæœ¬ä¿¡æ¯
â””â”€â”€ å¯åŠ¨åº”ç”¨.bat                   # å¯åŠ¨è„šæœ¬
```

### ğŸ›ï¸ é«˜çº§é…ç½®

#### è‡ªå®šä¹‰æ„å»ºè§¦å‘æ¡ä»¶

ç¼–è¾‘ `.github/workflows/build-windows.yml`ï¼š

```yaml
on:
  push:
    branches: [ main, develop, feature/* ]  # æŒ‡å®šåˆ†æ”¯
    paths: 
      - 'app/**'                           # åªæœ‰appç›®å½•å˜åŒ–æ‰æ„å»º
  schedule:
    - cron: '0 2 * * 0'                    # æ¯å‘¨æ—¥å‡Œæ™¨2ç‚¹è‡ªåŠ¨æ„å»º
```

#### æ·»åŠ æ„å»ºé€šçŸ¥

```yaml
- name: ğŸ“§ å‘é€æ„å»ºé€šçŸ¥
  if: always()
  uses: 8398a7/action-slack@v3
  with:
    status: ${{ job.status }}
    text: Windowsæ„å»º${{ job.status == 'success' && 'æˆåŠŸ' || 'å¤±è´¥' }}
  env:
    SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK }}
```

#### å¤šç‰ˆæœ¬å¹¶è¡Œæ„å»º

```yaml
strategy:
  matrix:
    flutter-version: ['3.22.0', '3.24.0']
    build-type: ['debug', 'release']
```

### ğŸ” æ•…éšœæ’é™¤

#### å¸¸è§æ„å»ºå¤±è´¥åŸå› ï¼š

1. **ä¾èµ–é—®é¢˜**
   ```
   è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥pubspec.yamlä¸­çš„ä¾èµ–ç‰ˆæœ¬
   ```

2. **ä»£ç åˆ†æé”™è¯¯**
   ```
   è§£å†³æ–¹æ¡ˆï¼šè¿è¡Œ flutter analyze ä¿®å¤ä»£ç é—®é¢˜
   ```

3. **æµ‹è¯•å¤±è´¥**
   ```
   è§£å†³æ–¹æ¡ˆï¼šè¿è¡Œ flutter test ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
   ```

4. **Windowsç‰¹å®šé—®é¢˜**
   ```
   è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†ä¸æ”¯æŒWindowsçš„æ’ä»¶
   ```

#### è°ƒè¯•æŠ€å·§ï¼š

1. **å¯ç”¨è¯¦ç»†æ—¥å¿—**
   ```yaml
   - name: ğŸ”¨ æ„å»ºWindowsåº”ç”¨
     run: flutter build windows --release --verbose
   ```

2. **ä¿ç•™æ„å»ºç¼“å­˜**
   ```yaml
   - name: ğŸ’¾ ç¼“å­˜Flutterä¾èµ–
     uses: actions/cache@v3
     with:
       path: ~/.pub-cache
       key: ${{ runner.os }}-pub-${{ hashFiles('**/pubspec.lock') }}
   ```

3. **åˆ†æ­¥æ„å»º**
   ```yaml
   - name: ğŸ§ª æµ‹è¯•æ„å»º
     run: flutter build windows --debug
   - name: ğŸš€ æ­£å¼æ„å»º  
     run: flutter build windows --release
   ```

### ğŸ“ˆ æ„å»ºä¼˜åŒ–

#### åŠ é€Ÿæ„å»ºï¼š

1. **ä½¿ç”¨ç¼“å­˜**
   ```yaml
   - uses: subosito/flutter-action@v2
     with:
       cache: true  # å¯ç”¨Flutterç¼“å­˜
   ```

2. **å¹¶è¡Œæ‰§è¡Œ**
   ```yaml
   - name: ğŸ“¦ å®‰è£…ä¾èµ– & ğŸ” ä»£ç åˆ†æ
     run: |
       flutter pub get &
       flutter analyze &
       wait
   ```

3. **è·³è¿‡ä¸å¿…è¦æ­¥éª¤**
   ```yaml
   - name: ğŸ§ª è¿è¡Œæµ‹è¯•
     if: github.event_name == 'pull_request'  # ä»…PRæ—¶è¿è¡Œæµ‹è¯•
   ```

### ğŸ‰ ä½¿ç”¨å»ºè®®

1. **å®šæœŸæ„å»º**ï¼šè®¾ç½®å®šæ—¶æ„å»ºç¡®ä¿ä»£ç å§‹ç»ˆå¯æ„å»º
2. **ç‰ˆæœ¬ç®¡ç†**ï¼šä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ ‡ç­¾
3. **æ„å»ºé€šçŸ¥**ï¼šé…ç½®Slack/é‚®ä»¶é€šçŸ¥
4. **å®‰å…¨å­˜å‚¨**ï¼šä½¿ç”¨GitHub Secretså­˜å‚¨æ•æ„Ÿä¿¡æ¯
5. **æ–‡æ¡£æ›´æ–°**ï¼šä¿æŒREADMEå’Œæ„å»ºè¯´æ˜åŒæ­¥

### ğŸ’¡ æœ€ä½³å®è·µ

- âœ… æ¯æ¬¡æ¨é€å‰æœ¬åœ°æµ‹è¯•
- âœ… ä½¿ç”¨åˆ†æ”¯ä¿æŠ¤è§„åˆ™
- âœ… å®šæœŸæ¸…ç†æ—§çš„æ„å»ºäº§ç‰©
- âœ… ç›‘æ§æ„å»ºæ—¶é—´å’ŒæˆåŠŸç‡
- âœ… ä¸ºä¸åŒç¯å¢ƒåˆ›å»ºä¸åŒçš„å·¥ä½œæµ

è¿™æ ·ï¼Œä½ å°±å¯ä»¥å®Œå…¨åœ¨äº‘ç«¯è‡ªåŠ¨æ„å»ºWindowsç‰ˆæœ¬ï¼Œæ— éœ€æœ¬åœ°Windowsç¯å¢ƒï¼ğŸš€